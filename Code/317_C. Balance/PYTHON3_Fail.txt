n, v, e = (int(i) for i in input().split())
a = [0] * (n + 15)
b = [0] * (n + 15)
E = [[] for i in range(n)]
f = [int(i) for i in range(n)]
vis = [0] * (n + 15)
res = []
re = 0
def fd(x):
    if f[x] == x:
        return x
    else:
        f[x] = fd(f[x])
        return f[x]
def dfs2(u, f, ty):
    global re
    if re <= a[u] and re > 0:
        if ty == 0: res.append([f,u, re])
        a[u] -= re
        a[f] += re
        re = 0
    else:
        re -= a[u]
        for v in E[u]:
            if v == f or vis[v]: continue
            dfs2(v, u, ty)
            if re == 0:break
        if f != -1:
            if ty == 0: res.append([u, f, a[u]])
            else: res.append([f,u, a[u]])
            a[f] += a[u]
            a[u] = 0
def solve(c):
    if a[c] == b[c]: return
    global re
    if a[c] < b[c]:
        re = b[c]
        dfs2(c, -1, 0)
    else:
        for i in range(n):
            a[i], b[i] = v - a[i], v - b[i]
            re = b[c]
            dfs2(c, -1, 1)
            for i in range(n):
                a[i], b[i] = v - a[i], v - b[i]
def dfs(u, f):
    for v in E[u]:
        if v == f: continue
        dfs(v, u)
    solve(u)
    vis[u] = 1
a = list(map(int, input().split()))
b = list(map(int, input().split()))
for i in range(e):
    x, y  = map(lambda x: int(x) - 1, input().split())
    if fd(x) != fd(y):
        E[x].append(y)
        E[y].append(x)
        f[fd(x)] = fd(y)
for i in range(n):
    if fd(i) != i: continue
    sa = sum(a[j] for j in range(n) if (fd(j) == i))
    sb = sum(b[j] for j in range(n) if (fd(j) == i))
    if sa != sb:
        print("NO")
        exit()
    dfs(i, -1)
print(len(res))
for c in res:
    print(c[0] + 1, c[1] + 1, c[2])
    
'''
#A
m, n = map(int, input().split())
if m % 2 == 1:
    if n <= (m + 1) // 2:
        print(2 * n - 1)
    else:
        print(2 * n - (m + 1))
else:
    if n <= m // 2:
        print(2 * n - 1)
    else:
        print(2 * n - m)


#B
s = input()
l = s.split('heavy')
res = 0
for i in range(1, len(l)):
    res += i * l[i].count('metal')
print(res)

#C
s = input().split()
x, y, m = (int(i) for i in s)
res = 0
if x >= m or y >= m:
    print(0)
elif x <= 0 and y <= 0:
        print(-1)
else:
    if x < 0:
        q = abs(x // y)
        res += q
        x += y * q
    elif y < 0:
        q = abs(y // x)
        res += q
        y += x * q
    while x < m and y < m:
        res += 1
        if x < y:
            x += y
        else:
            y += x
    print(res)
'''