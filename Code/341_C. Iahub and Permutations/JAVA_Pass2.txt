import java.util.*;
import java.io.*;

public class BrokenSequence {
	public static void main(String[] args) throws IOException {
		BufferedReader rd = new BufferedReader(new InputStreamReader(System.in));
		n = Integer.parseInt(rd.readLine());
		StringTokenizer st = new StringTokenizer(rd.readLine());
		int numMissing = 0;
		int[] a = new int[n];
		boolean[] index = new boolean[n];
		boolean[] inA = new boolean[n];
		for (int i = 0; i < n; i++) {
			a[i] = Integer.parseInt(st.nextToken());
			if (a[i] == -1) {
				index[i] = true;
				numMissing++;
			} else {
				a[i]--;
				inA[a[i]] = true;
			}
		}
		int numFree = 0;
		for (int i = 0; i < n; i++) {
			if (!inA[i]) {
				if (!index[i])
					numFree++;
			}
		}
		System.out.println(count(numMissing, numFree));
	}

	static long count(int num, int free) {
		if (free < 0)
			return 0;
		if (calculated[num][free])
			return dp[num][free];
		if (num == 0) {
			int ans = (free == 0 ? 1 : 0);
			calculated[num][free] = true;
			return dp[num][free] = ans;
		}
		long ans = 0;
		if (free > 0) {
			ans = (ans + count(num - 1, free - 1) * free) % P;
			ans = (ans + (num - free) * count(num - 1, free)) % P;
		} else {
			ans = (ans + count(num - 1, free + 1) * (num - 1)) % P;
			calculated[num][free] = true;
			return dp[num][free] = ans;
		}
		calculated[num][free] = true;
		return dp[num][free] = ans;
	}

	static long[][] dp = new long[2001][2001];

	static boolean[][] calculated = new boolean[2001][2001];

	static long P = 1000000007;

	static int n;

}