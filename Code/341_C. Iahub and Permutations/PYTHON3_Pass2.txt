def fact(x):
    ans=1
    for i in range(2,x+1):
        ans*=i
    return ans
n=int(input())
a=[int(x) for x in input().split()]
s=set(a)
x=0
y=0
for i in range(1,n+1):
    if a[i-1]==-1:
        if i in s:
            y+=1
        else:
            x+=1
otv = fact(x + y)
currf=fact(x+y-1)//fact(x-1)*fact(x)
if x:
    otv-=currf
for i in range(2,x+1):
    currf//=i
    currf*=x-i+1
    currf//=x+y-i+1
    if i&1:
        otv-=currf
    else:
        otv+=currf
otv%=1000000007
print(otv)