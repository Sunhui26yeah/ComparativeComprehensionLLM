#include <bits/stdc++.h>
using namespace std;
const long long mod = 1000000007LL;
const int maxN = 2100;
long long c[maxN][maxN];
int a[maxN];
int ps[maxN];
int u[maxN];
int n;
long long dp[maxN];
long long f[maxN];
int main() {
  f[0] = f[1] = 1;
  for (int i = 2; i < maxN; ++i) {
    f[i] = (long long)i * f[i - 1];
    f[i] %= mod;
  }
  dp[1] = 0;
  dp[2] = 1;
  for (int i = 3; i < maxN; ++i) {
    dp[i] = (long long)(i - 1) * (dp[i - 1] + dp[i - 2]);
    dp[i] %= mod;
  }
  c[0][0] = 1LL;
  for (int i = 1; i < maxN; ++i) {
    c[i][0] = 1LL;
    for (int j = 1; j <= i; ++j) {
      c[i][j] = c[i - 1][j - 1] + c[i - 1][j];
      if (c[i][j] >= mod) {
        c[i][j] -= mod;
      }
    }
  }
  scanf("%d", &n);
  int tot = 0;
  for (int i = 1; i <= n; ++i) {
    scanf("%d", &a[i]);
    if (a[i] == -1) {
      u[i] = 1;
      ++tot;
    } else {
      ps[a[i]] = i;
    }
  }
  int com = 0;
  for (int i = 1; i <= n; ++i) {
    if (u[i] && !ps[i]) {
      ++com;
    }
  }
  int k = tot - com;
  if (com == 0) {
    cout << f[k] << endl;
    return 0;
  }
  long long res = dp[tot];
  for (int i = 1; i <= k; ++i) {
    if (i % 2 == 1) {
      res += (c[k][i] * dp[tot - i]) % mod;
      res %= mod;
    } else {
      res += (c[k][i] * dp[tot - i]) % mod;
      res %= mod;
    }
  }
  cout << ((res % mod) + mod) % mod << endl;
  return 0;
}