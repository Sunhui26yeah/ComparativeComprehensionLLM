MOD = 10**9+7
n = int(input())

notUsed = set(range(1, n+1))
chairs = set()
for i, a in enumerate(map(int, input().split()), 1):
    if a == -1:
        chairs.add(i)
    else:
        notUsed -= {a}
fixed = len(chairs & notUsed)

m = len(notUsed)

fact = [0]*(m+1)
fact[0] = 1
for i in range(1, m+1):
    fact[i] = fact[i-1]*i % MOD

fact_inv = [0]*(m+1)
fact_inv[m] = pow(fact[m], MOD-2, MOD)
for i in reversed(range(m)):
    fact_inv[i] = fact_inv[i + 1]*(i + 1) % MOD


def nCr(n, r):
    if r < 0 or n < r:
        return 0
    return int(fact[n] * fact_inv[r] * fact_inv[n-r])

ans = fact[m]
for k in range(1, fixed+1):
    ans += nCr(fixed, k)*fact[m-k]*(-1)**k
    ans %= MOD
print(ans)