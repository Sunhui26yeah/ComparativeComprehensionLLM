import java.io.*;
import java.util.ArrayList;
import java.util.StringTokenizer;
import java.util.TreeSet;

public class C {
    static BufferedReader br;
    static StringTokenizer st;

    static String nextToken() {
        try {
            while (st == null || !st.hasMoreTokens()) {
                st = new StringTokenizer(br.readLine());
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
        return st.nextToken();
    }

    static String nextString() throws IOException {
        return br.readLine();
    }

    static char nextChar() throws IOException {
        return (char) br.read();
    }

    private static int nextInt() {
        return Integer.parseInt(nextToken());
    }

    static ArrayList<Integer>[] graf;

    public static void main(String[] args) throws IOException {
        br = new BufferedReader(new InputStreamReader(System.in));
        PrintWriter pw = new PrintWriter(System.out);
        int n = nextInt();
        int k = nextInt();
        graf = new ArrayList[n];
        for (int i = 0; i < n; i++) {
            graf[i] = new ArrayList<>();
        }
        for (int i = 0; i < n - 1; i++) {
            int x = nextInt() - 1;
            int y = nextInt() - 1;
            int s = nextInt();
            if (s == 0) {
                graf[x].add(y);
                graf[y].add(x);
            }
        }
        tr = new boolean[n];
        for (int i = 0; i < n; i++) {
            if (!tr[i]) {
                b.add(new TreeSet<>());
                id++;
                dfs(i);
            }
        }
        long ans = n;
        for (int i = 1; i < k; i++) {
            ans *= n;
            ans %= 1000000007;
        }
        for (int i = 0; i < b.size(); i++) {
            long km = 1;
            for (int j = 0; j < k; j++) {
                km = km * b.get(i).size() % 1000000007;
            }
            ans -= km;
            ans %= 1000000007;
        }
        System.out.println(ans);
        pw.close();
    }

    static int id = -1;
    static ArrayList<TreeSet<Integer>> b = new ArrayList<>();
    static boolean[] tr;

    private static void dfs(int v) {
        if (tr[v]) {
            return;
        }
        tr[v] = true;
        b.get(id).add(v);
        for (int i = 0; i < graf[v].size(); i++) {
            dfs(graf[v].get(i));
        }
    }
}