import java.io.*;
import java.math.BigDecimal;
import java.math.BigInteger;
import java.util.*;
public class tr {
static int n,k;
static boolean []vis;
static ArrayList<Integer> []ad;
	public static void main(String[] args) throws IOException, InterruptedException {
		Scanner sc=new Scanner(System.in);
		PrintWriter out=new PrintWriter(System.out);
		 n=sc.nextInt();
		 k=sc.nextInt();
		 ad=new ArrayList[n];
		for(int i=0;i<n;i++)
			ad[i]=new ArrayList();
		for(int i=0;i<n-1;i++) {
			int a=sc.nextInt()-1;
			int b=sc.nextInt()-1;
			int t=sc.nextInt();
			if(t==0) {
				ad[a].add(b);
				ad[b].add(a);
			}
		}
		
		vis=new boolean [n];
			long num=fast_pow(n,k);
            long sum=0;
            for(int i=0;i<n;i++) {
            	 c=0;
            	if(!vis[i]) {
            		dfs(i);
            	}
            	sum+=cal(c)%mod;
            }
            sum%=mod;
         //   System.out.println(num+" num");
         //   System.out.println(sum+" sum");
         //   System.out.println((num-sum)+" 2sum");
            num = (num - sum + mod) % mod;
            out.println(num);
			out.flush();
	}
	static long fast_pow(long a, long b) {
		if(b == 0)
			return 1L;

		long val = fast_pow(a, b / 2);

		if(b % 2 == 0)
			return val * val % mod;
		else 
			return val * val % mod * a % mod;
	}
	static int c;
	static void dfs(int s) {
		c++;
		vis[s]=true;
		for(int u:ad[s])
			if(!vis[u])
				dfs(u);
	}
	static long cal(int r) {
		long ans=r;
		int u=k;
		while(--u>0) {
			ans=(ans*r)%mod;
		}
		return ans;
	}
	static long mod=(long)1e9+7;
	static class pair2 implements Comparable<pair2> {
		long a;
		long b;
		pair2(long a, long b) {
			this.a = a;
			this.b = b;
		}

		public String toString() {
			return a + " " + b;
		}
		public int compareTo(pair2 o) {
			if(o.b<b)
			  return 1;
			else if(o.b>b)
			  return -1;
			return 0;			
		}
	}
	static class pair implements Comparable<pair> {
		long a;
		int b;
		pair(long a, int b) {
			this.a = a;
			this.b = b;
		}

		public String toString() {
			return a + " " + b;
		}

		@Override
		public int compareTo(pair o) {
			//if(o.a!=a)
			//return  a-o.a ;
            return b-o.b;			
		}
	}
	static int gcd(int a,int b) {
		if(b==0) {
			return a;
		}	
		return gcd(b,a%b);
	}
	static class Scanner {
		StringTokenizer st;
		BufferedReader br;

		public Scanner(InputStream system) {
			br = new BufferedReader(new InputStreamReader(system));
		}

		public Scanner(String file) throws Exception {
			br = new BufferedReader(new FileReader(file));
		}

		public String next() throws IOException {
			while (st == null || !st.hasMoreTokens())
				st = new StringTokenizer(br.readLine());
			return st.nextToken();
		}

		public String nextLine() throws IOException {
			return br.readLine();
		}

		public int nextInt() throws IOException {
			return Integer.parseInt(next());
		}

		public double nextDouble() throws IOException {
			return Double.parseDouble(next());
		}

		public char nextChar() throws IOException {
			return next().charAt(0);
		}

		public Long nextLong() throws IOException {
			return Long.parseLong(next());
		}

		public boolean ready() throws IOException {
			return br.ready();
		}

		public void waitForInput() throws InterruptedException {
			Thread.sleep(3000);
		}
	}
}