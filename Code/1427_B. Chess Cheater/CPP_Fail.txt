#include <bits/stdc++.h>
using namespace std;
const long long M = 1e9 + 7;
const long long N = 1e3 + 10;
const long long IM = 1e18 + 37;
inline void PP(long long n) { cout << n << " "; }
void PV(vector<long long> v) {
  for (long long i = 0; i < v.size(); i++) cout << v[i] << " ";
  cout << "\n";
}
void PVV(vector<pair<long long, long long> > v) {
  for (long long i = 0; i < v.size(); i++)
    cout << v[i].first << " " << v[i].second << "\n";
}
void PA(long long v[], long long n, long long x = 0) {
  for (long long i = x; i < n + x; i++) cout << v[i] << ' ';
  cout << "\n";
}
void IN(long long a[], long long n, long long x = 0) {
  for (long long i = x; i < n + x; i++) cin >> a[i];
}
inline void op() {}
signed main() {
  ios_base::sync_with_stdio(false);
  cin.tie(NULL);
  cout.tie(NULL);
  op();
  long long t;
  cin >> t;
  while (t--) {
    long long n, k;
    cin >> n >> k;
    string s;
    cin >> s;
    vector<long long> v;
    bool f = 0;
    long long x = 0, ans = 0;
    vector<long long> b;
    for (long long i = 0; i < n; i++) {
      if (s[i] == 'W') {
        if (f) {
          v.push_back(x);
          x = 0;
        } else {
          b.push_back(x);
          x = 0;
        }
        f = 1;
        if (i && s[i - 1] == 'W')
          ans += 2;
        else if (s[i] == 'W')
          ans++;
      } else
        x++;
    }
    if (x) {
      b.push_back(x);
    }
    sort(v.begin(), v.end());
    for (auto it : v) {
      long long x = it;
      if (!x) continue;
      if (it <= k) {
        ans += it + it + 1;
        k = k - it;
      } else {
        ans += k + k;
        k = 0;
      }
      if (k == 0) break;
    }
    if (k != 0 && b.size()) {
      if (v.size() == 0) {
        long long x = min(n, k);
        ans += x + x - 1;
      } else {
        for (auto it : b) {
          long long x = min(it, k);
          ans += x + x;
          k = k - x;
        }
      }
    }
    cout << (ans) << "\n";
  }
  return 0;
}